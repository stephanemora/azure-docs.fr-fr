---
title: Évaluation des vulnérabilités sur des machines virtuelle BYOL dans Azure Security Center
description: Déployez une solution d’évaluation des vulnérabilités BYOL sur vos machines virtuelles Azure pour obtenir des recommandations d’Azure Security Center qui vous permettent de les protéger.
services: security-center
documentationcenter: na
author: memildin
manager: rkarlin
ms.service: security-center
ms.devlang: na
ms.topic: how-to
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 11/22/2020
ms.author: memildin
ms.openlocfilehash: 744278d95d6d3ae839e20e038da9e71dbd4ef23d
ms.sourcegitcommit: 4b7a53cca4197db8166874831b9f93f716e38e30
ms.translationtype: HT
ms.contentlocale: fr-FR
ms.lasthandoff: 03/04/2021
ms.locfileid: "102095610"
---
# <a name="deploy-a-bring-your-own-license-byol-vulnerability-assessment-solution"></a>Déployer une solution d’évaluation des vulnérabilités BYOL (apportez votre propre licence)

Si vous avez activé **Azure Defender pour les serveurs**, vous pouvez utiliser l’outil d’évaluation des vulnérabilités intégré d’Azure Security Center, comme décrit dans [Analyseur de vulnérabilité intégré pour machines virtuelles](./deploy-vulnerability-assessment-vm.md). Cet outil est intégré à Azure Defender et ne nécessite aucune licence externe. Tout est géré en toute transparence dans Security Center. En outre, l’analyseur intégré prend en charge les machines compatibles Azure Arc.

Vous pouvez également déployer votre propre solution d’évaluation des vulnérabilités sous licence privée proposée par [Qualys](https://www.qualys.com/lp/azure) ou [Rapid7](https://www.rapid7.com/products/insightvm/). Vous pouvez installer l’une de ces solutions de partenaires sur plusieurs machines virtuelles qui appartiennent au même abonnement (mais pas sur les machines compatibles avec Azure Arc).

## <a name="availability"></a>Disponibilité

|Aspect|Détails|
|----|:----|
|État de sortie :|Disponibilité générale (GA)|
|Types de machines (scénarios hybrides) :|![Oui](./media/icons/yes-icon.png) Machines virtuelles Azure<br>![Non](./media/icons/no-icon.png) Machines compatibles avec Azure Arc|
|Prix :|Gratuit|
|Rôles et autorisations obligatoires :|Le **propriétaire de la ressource** peut déployer l’analyseur<br>Le **Lecteur de sécurité** peut afficher les résultats|
|Clouds :|![Oui](./media/icons/yes-icon.png) Clouds commerciaux<br>![Non](./media/icons/no-icon.png) National/souverain (US Gov, Chine Gov, autres Gov)|
|||


## <a name="deploy-a-byol-solution-from-the-azure-portal"></a>Déployer une solution BYOL à partir du portail Azure

Les options BYOL font référence aux solutions tierces prises en charge pour l’évaluation des vulnérabilités. À l’heure actuelle, Qualys et Rapid7 sont tous deux des fournisseurs pris en charge.

Les solutions prises en charge rapportent les données de vulnérabilité à la plateforme de gestion du partenaire. En retour, cette plateforme fournit des données de supervision de l’intégrité et des vulnérabilités à Security Center. Vous pouvez identifier les machines virtuelles vulnérables dans le tableau de bord Security Center et basculer sur la console de gestion partenaire directement depuis Security Center pour obtenir des rapports et des informations supplémentaires.

1. Dans le [Portail Azure](https://azure.microsoft.com/features/azure-portal/), ouvrez **Security Center**.

1. Dans le menu de Security Center, ouvrez la page **Recommandations**.

1. Sélectionnez la recommandation **Une solution d’évaluation des vulnérabilités doit être activée sur vos machines virtuelles**.

    :::image type="content" source="./media/deploy-vulnerability-assessment-vm/recommendation-page-machine-groupings.png" alt-text="Regroupements des machines sur la page de la recommandation **Une solution d’évaluation des vulnérabilités doit être activée sur vos machines virtuelles**" lightbox="./media/deploy-vulnerability-assessment-vm/recommendation-page-machine-groupings.png":::

    Vos machines virtuelles s’affichent dans un ou plusieurs des groupes suivants :

    * **Ressources saines** : Security Center a détecté une solution d’évaluation des vulnérabilités exécutée sur ces machines virtuelles.
    * **Ressources non saines** : une extension de l’analyseur de vulnérabilité peut être déployée sur ces machines virtuelles. 
    * **Ressources non applicables** : une extension de l’analyseur de vulnérabilité ne peut pas être déployée sur ces machines virtuelles.

1. Dans la liste des machines non saines, sélectionnez celles qui doivent recevoir une solution d’évaluation des vulnérabilités et sélectionnez **Corriger**.

    >[!IMPORTANT]
    > En fonction de votre configuration, vous ne verrez peut-être qu’une partie de cette liste. 
    >
    > - Si vous n’avez pas configuré d’analyseur de vulnérabilité tiers, vous n’avez pas la possibilité de le déployer.
    > - Si vos machines virtuelles sélectionnées ne sont pas protégées avec Azure Defender, l’option intégrée d’analyse des vulnérabilités ASC n’est pas disponible.

    :::image type="content" source="./media/deploy-vulnerability-assessment-vm/recommendation-remediation-options.png" alt-text="Options pour le type de flux de correction que vous souhaitez choisir lors de la réponse à la recommandation sur la page **Une solution d’évaluation des vulnérabilités doit être activée sur vos machines virtuelles**":::

1. Si vous établissez une nouvelle configuration BYOL, sélectionnez **Configurer un nouvel analyseur de vulnérabilité tiers**, choisissez l’extension pertinente, appuyez sur **Continuer**, puis entrez les informations du fournisseur comme suit :

    1. Pour **Groupe de ressources**, sélectionnez **Use existing** (Utiliser existant).
    1. Pour **Emplacement**, sélectionnez l’emplacement géographique de la solution.
    1. Pour Qualys, entrez la licence fournie par Qualys dans le champ **Code de licence**.
    1. Pour Rapid7, chargez le **fichier config Rapid7**.
    1. Dans la zone **Clé publique**, entrez les informations de clé publique fournies par le partenaire.
    1. Pour installer automatiquement cet agent d’évaluation des vulnérabilités sur toutes les machines virtuelles détectées dans l’abonnement de cette solution, sélectionnez **Déploiement automatique**.
    1. Sélectionnez **OK**.

1. Si vous avez déjà configuré votre solution BYOL, sélectionnez **Déployer votre analyseur de vulnérabilité tiers configuré**, choisissez l’extension pertinente et appuyez sur **Continuer**.

Une fois la solution d’évaluation des vulnérabilités installée sur les machines cibles, Azure Security Center effectue une analyse pour détecter et identifier les vulnérabilités de l’application et du système. La première analyse peut durer jusqu'à deux heures. Après cela, elle s’exécute toutes les heures.



## <a name="deploy-a-byol-solution-using-powershell-and-the-rest-api"></a>Déployer une solution BYOL à l’aide de PowerShell et de l’API REST

Pour déployer programmatiquement votre propre solution d’évaluation des vulnérabilités sous licence privée proposée par [Qualys](https://www.qualys.com/lp/azure) ou [Rapid7](https://www.rapid7.com/products/insightvm/), utilisez le script fourni [PowerShell > Solution de vulnérabilité](https://github.com/Azure/Azure-Security-Center/tree/master/Powershell%20scripts/Vulnerability%20Solution). Ce script utilise l’API REST pour créer une nouvelle solution de sécurité dans ASC. Vous aurez besoin d’une licence et d’une clé fournies par votre fournisseur de services (Qualys ou Rapid7).

> [!IMPORTANT] 
> Une seule solution peut être créée par licence. Toute tentative de création d’une autre solution avec les mêmes nom, licence ou clé échouera.

### <a name="prerequisites"></a>Prérequis

Modules PowerShell nécessaires :

- Install-module Az
- Install-module Az.security

### <a name="run-the-script"></a>Exécuter le script

Pour exécuter le script, vous avez besoin des informations appropriées pour les paramètres ci-dessous.

| **Paramètre** | **Obligatoire** | **Remarques** |
|----|:----:|----|
|**SubscriptionId**|✔|Identificateur subscriptionID de l’abonnement Azure qui contient les ressources que vous souhaitez analyser.|
|**ResourceGroupName**|✔|Nom du groupe de ressources. Utilisez n’importe quel groupe de ressources existant, y compris le groupe par défaut (« DefaultResourceGroup-xxx »). Comme la solution n’est pas une ressource Azure, elle ne figure pas sous le groupe de ressources, mais elle lui est toutefois attachée.|
|**vaSolutionName**|✔|Nom de la nouvelle solution.|
|**vaType**|✔|Qualys ou Rapid7.|
|**licenceCode**|✔|Chaîne de licence fournie par le fournisseur.|
|**publicKey**|✔|Clé publique fournie par le fournisseur.|
|**autoUpdate**|-|Activez (true) ou désactivez (false) le déploiement automatique pour cette solution d’évaluation des vulnérabilités. Lorsque cette option est activée, chaque nouvelle machine virtuelle de l’abonnement tente automatiquement de créer un lien vers la solution.<br/>(Par défaut : False)|
||||

Syntaxe :

```azurepowershell
.\New-ASCVASolution.ps1 -subscriptionId <Subscription Id> -resourceGroupName <RG Name>
-vaSolutionName <New solution name> -vaType <Qualys / Rapid7> -autoUpdate <true/false>
-licenceCode <License code from vendor> -publicKey <Public Key received from vendor>
```

Exemple (cet exemple n’inclut pas de détails de licence valides) :

```azurepowershell
.\New-ASCVASolution.ps1 -subscriptionId 'f4cx1b69-dtgb-4ch6-6y6f-ea2e95373d3b' -resourceGroupName 'DefaultResourceGroup-WEU' -vaSolutionName 'QualysVa001' -vaType 'Qualys' -autoUpdate 'false' `
-licenceCode 'eyJjaWQiOiJkZDg5OTYzXe4iMTMzLWM4NTAtODM5FD2mZWM1N2Q3ZGU5MjgiLCJgbTYuOiIyMmM5NDg3MS1lNTVkLTQ1OGItYjhlMC03OTRhMmM3YWM1ZGQiLCJwd3NVcmwiOiJodHRwczovL3FhZ3B1YmxpYy1wMDEuaW50LnF1YWx5cy5jb20vQ2xvdSKJY6VudC8iLCJwd3NQb3J0IjoiNDQzIn0=' `
-publicKey 'MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCOiOLXjOywMfLZIBGPZLwSocf1Q64GASLK9OHFEmanBl1nkJhZDrZ4YD5lM98fThYbAx1Rde2iYV1ze/wDlX4cIvFAyXuN7HbdkeIlBl6vWXEBZpUU17bOdJOUGolzEzNBhtxi/elEZLghq9Chmah82me/okGMIhJJsCiTtglVQIDAQAB'
```

## <a name="faq---byol-vulnerability-scanner"></a>Questions fréquentes (FAQ) - Analyseur de vulnérabilité BYOL

### <a name="if-i-deploy-a-qualys-agent-what-communications-settings-are-required"></a>Si je déploie un agent Qualys, quels sont les paramètres de communication obligatoires ?

L’agent cloud Qualys est conçu pour communiquer avec le SOC de Qualys à intervalles réguliers pour les mises à jour, et pour effectuer les différentes opérations nécessaires aux fonctionnalités du produit. Pour permettre à l’agent de communiquer de façon continue avec le SOC, configurez la sécurité de votre réseau afin d’autoriser le trafic entrant et sortant sur les URL et le routage CIDR (Classless InterDomain Routing) du SOC.

Il existe plusieurs plateformes Qualys dans différentes localisations géographiques. Le routage CIDR (Classless InterDomain Routing) et les URL du SOC varient en fonction de la plateforme hôte de votre abonnement Qualys. Pour identifier votre plateforme hôte Qualys, utilisez cette page : https://www.qualys.com/platform-identification/.


## <a name="next-steps"></a>Étapes suivantes

> [!div class="nextstepaction"]
> [Corriger les résultats de votre solution d’évaluation des vulnérabilités](remediate-vulnerability-findings-vm.md)


Security Center offre également une analyse des vulnérabilités pour les éléments suivants :

- Bases de données SQL : consultez [Explorer les rapports d’évaluation des vulnérabilités dans le tableau de bord de l’évaluation des vulnérabilités](defender-for-sql-on-machines-vulnerability-assessment.md#explore-vulnerability-assessment-reports).
- Images Azure Container Registry – Consultez [Analyse des vulnérabilités dans les images avec Azure Defender pour les registres de conteneurs](defender-for-container-registries-usage.md)